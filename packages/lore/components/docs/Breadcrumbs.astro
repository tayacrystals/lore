---
import { Icon } from "astro-icon/components";

const path = Astro.url.pathname.replace(/\/$/, "");
const segments = path.split("/").filter(Boolean);

function titleCase(s: string) {
  return s
    .split("-")
    .map((w) => w.charAt(0).toUpperCase() + w.slice(1))
    .join(" ");
}

const crumbs = segments.map((seg, i) => ({
  label: titleCase(seg),
  href: "/" + segments.slice(0, i + 1).join("/"),
  current: i === segments.length - 1,
}));
---

{
  crumbs.length > 1 && (
    <nav class="flex items-center gap-1 text-[13px] text-fd-muted-foreground mb-6" aria-label="Breadcrumb">
      {crumbs.map((crumb, i) => (
        <>
          {i > 0 && (
            <Icon name="lucide:chevron-right" class="w-3 h-3 opacity-50" />
          )}
          {crumb.current ? (
            <span class="text-fd-foreground">{crumb.label}</span>
          ) : (
            <a href={crumb.href} class="hover:text-fd-foreground transition-colors">
              {crumb.label}
            </a>
          )}
        </>
      ))}
    </nav>
  )
}
